(window.webpackJsonpwebapp=window.webpackJsonpwebapp||[]).push([[0],{11:function(e,a,t){e.exports=t(26)},18:function(e,a,t){},19:function(e,a,t){},26:function(e,a,t){"use strict";t.r(a);var n,r=t(0),c=t.n(r),s=t(9),l=t.n(s),o=(t(16),t(17),t(18),t(19),t(2)),i=t(3);!function(e){e[e.CONNECTED=0]="CONNECTED",e[e.DISCONNECTED=1]="DISCONNECTED"}(n||(n={}));var m,u=function(e){var a=e.wsStatus;return c.a.createElement("nav",{className:"navbar",role:"navigation","aria-label":"main navigation"},c.a.createElement("div",{className:"navbar-brand"},c.a.createElement("a",{className:"navbar-item",href:"/"},"Is the Bathroom Available?"),c.a.createElement("div",{className:"navbar-item connected-status"},a===n.CONNECTED&&c.a.createElement(c.a.Fragment,null,c.a.createElement("span",{className:"connected-status-message is-hidden-mobile"},"Connected"),c.a.createElement("span",{className:"icon"},c.a.createElement(o.a,{icon:i.c}))),a===n.DISCONNECTED&&c.a.createElement(c.a.Fragment,null,c.a.createElement("span",{className:"connected-status-message is-hidden-mobile"},"Disconnected"),c.a.createElement("span",{className:"icon"},c.a.createElement(o.a,{icon:i.b}))))))},E=t(5),d=t(6),p=t.n(d),N=function(e){var a=e.start,t=Object(r.useState)("..."),n=Object(E.a)(t,2),s=n[0],l=n[1];return Object(r.useEffect)(function(){var e=setInterval(function(){l(function(e){var a=p()(e,"YYYY-MM-DDTHH:mm:ssZ");return Object(d.duration)(a.diff(p()())).humanize(!0)}(a))},250);return function(){return clearInterval(e)}},[a]),c.a.createElement("span",null,s)},b=function(e){var a=e.history,t=e.latest;return c.a.createElement("nav",{className:"panel recent-availability-panel"},c.a.createElement("p",{className:"panel-heading has-text-centered"},"Recent Availability"),c.a.createElement("div",{className:"panel-block"},c.a.createElement("article",{className:"message current-availability-message ".concat(t.available?"is-success":"is-danger")},c.a.createElement("div",{className:"message-body"},"Currently ",c.a.createElement("strong",null,t.available?"available":"unavailable"),"."," ","Last seen ",c.a.createElement(N,{start:t.time}),"."))),a.slice(1).map(function(e){return c.a.createElement(c.a.Fragment,{key:e.time},!0===e.available&&c.a.createElement("div",{className:"panel-block has-background-success"}),!1===e.available&&c.a.createElement("div",{className:"panel-block has-background-danger"}),null===e.available&&c.a.createElement("div",{className:"panel-block"}))}))},v=function(){return c.a.createElement("footer",{className:"footer"},c.a.createElement("div",{className:"content has-text-centered"},c.a.createElement("p",null,"Made by ",c.a.createElement("a",{href:"https://github.com/tristanmkernan"},"Tristan")," ","with\xa0",c.a.createElement("a",{href:"https://reactjs.org/"},"react"),",\xa0",c.a.createElement("a",{href:"https://bulma.io/"},"bulma")," and\xa0",c.a.createElement(o.a,{icon:i.a}),". The source code is licensed\xa0",c.a.createElement("a",{href:"https://opensource.org/licenses/GPL-3.0"},"GPLv3+"),". The website\xa0content is licensed\xa0",c.a.createElement("a",{href:"http://creativecommons.org/licenses/by-nc-sa/4.0/"},"CC BY NC SA 4.0"),".")))},f=t(10);function S(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);a&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function C(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?S(t,!0).forEach(function(a){Object(f.a)(e,a,t[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):S(t).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))})}return e}!function(e){e[e.WS_CONNECT_SUCCESS=0]="WS_CONNECT_SUCCESS",e[e.WS_DISCONNECT=1]="WS_DISCONNECT",e[e.SET_DATA=2]="SET_DATA",e[e.SET_ERROR=3]="SET_ERROR"}(m||(m={}));var g={wsStatus:n.DISCONNECTED,data:null,error:null},O=function(e,a){switch(a.type){case m.WS_CONNECT_SUCCESS:return C({},e,{error:null,wsStatus:n.CONNECTED});case m.WS_DISCONNECT:return C({},e,{error:new Error("Disconnected from server!"),wsStatus:n.DISCONNECTED});case m.SET_DATA:return C({},e,{data:a.payload});case m.SET_ERROR:return C({},e,{error:a.payload});default:throw new Error("Received unidentified action: ".concat(a.type))}},h=function(){var e=Object(r.useReducer)(O,g),a=Object(E.a)(e,2),t=a[0],n=a[1],c=Object(r.useCallback)(function(){var e=new WebSocket("wss://bathroom-api.tmk.name/ws/status");e.onopen=function(e){n({type:m.WS_CONNECT_SUCCESS,payload:null})},e.onerror=function(e){n({type:m.SET_ERROR,payload:new Error("Something went wrong!")})},e.onmessage=function(e){"string"===typeof e.data&&(console.log(JSON.parse(e.data)),n({type:m.SET_DATA,payload:JSON.parse(e.data)}))},e.onclose=function(t){n({type:m.WS_DISCONNECT,payload:null}),clearInterval(a),e.close(),setTimeout(function(){return c()},5e3)};var a=setInterval(function(){e.send("SEND_DATA_PLZ_KTHXBAI")},3e4);return function(){clearInterval(a),e.close()}},[]);return Object(r.useEffect)(function(){return c()},[c]),t},w=function(e){var a=e.children,t=e.wsStatus;return c.a.createElement("div",{className:"container"},c.a.createElement(u,{wsStatus:t}),c.a.createElement("div",{className:"my-main-row"},a),c.a.createElement(v,null))},y=function(){var e=h(),a=e.data,t=e.wsStatus,r=e.error;return r?c.a.createElement(w,{wsStatus:t},c.a.createElement("article",{className:"message is-danger"},c.a.createElement("div",{className:"message-header"},c.a.createElement("p",null,"Error")),c.a.createElement("div",{className:"message-body"},r.message))):t===n.DISCONNECTED?c.a.createElement(w,{wsStatus:t},c.a.createElement("progress",{className:"progress is-medium is-primary",max:"100"},"15%")):a&&0!==a.recent.length?c.a.createElement(w,{wsStatus:t},c.a.createElement(b,{history:a.recent,latest:a.latest})):c.a.createElement(w,{wsStatus:t},c.a.createElement("article",{className:"message is-warning no-data-available-alert"},c.a.createElement("div",{className:"message-header"},c.a.createElement("p",null,"Warning"),c.a.createElement("span",{className:"icon"},c.a.createElement(o.a,{icon:i.b}))),c.a.createElement("div",{className:"message-body"},"No data available.")))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(c.a.createElement(y,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[11,1,2]]]);
//# sourceMappingURL=main.6dca29a6.chunk.js.map